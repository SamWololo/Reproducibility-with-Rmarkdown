---
title: "Amniote life-history"
author: "Sam Wolf"
date: "March 22, 2018"
output: 
  html_document:
    highlight: tango
    theme: journal
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r libraries, include=FALSE}
# Includes two important libraries that help answer our question
library(knitr)
library(tidyverse)

```

# Exploring the relationship of body size on lifestyle and productivity among Amniotes
##  How does body-size affect range distributions of amniotes?

Describe your question here

## Brief description of the methods

Using the Amniote life-history [database](http://www.esapubs.org/archive/ecol/E096/269/#data), I ...

```{r message=FALSE, warning=FALSE}
download.file("http://www.esapubs.org/archive/ecol/E096/269/Data_Files/Amniote_Database_Aug_2015.csv
", "./Data/Amniote_Database_Aug_2015.csv")

```
```{r}
# The code to read the data we just downloaded. 
Amniote<-read.csv("./Data/Amniote_Database_Aug_2015.csv")

# Use this code to view the .csv file (helpful to view vectors).
View(Amniote)
```

```{r}
# Since we have a lot of null values in the original data, represented as -999, we can make these into NA's to make the data more readable. 

# This code replaces -999 for NAs.
Amniote[Amniote==-999]<-NA
```


## Data exploration

### Number of genus per class of Amniotes 
```{r}
# Number species per class
Amniote %>% 
  group_by(class) %>% 
  summarise(N_genus=n_distinct(genus)) %>% 
  kable
```

### Number of orders per class of Amniotes
```{r}
# Number orders per class
Amniote %>% 
  group_by(class) %>% 
  summarise(N_order=n_distinct(order)) %>% 
  kable
```


### Number of species per order in Aves
```{r}
Amniote %>% 
  filter(class=="Aves") %>% 
  group_by(order) %>% 
  summarise(N_species=n_distinct(species)) %>% 
  kable

```


## Data visualization
### Correlation between body size (in log base e) distribution with respect to longevity
```{r}
# Relationship between longevity and body size among birds
Amniote %>% 
  filter(class!="Mammalia"& class!="Reptilia") %>% 
  ggplot(aes(x=maximum_longevity_y, y=log(adult_body_mass_g))) + 
  geom_density2d()+
  stat_smooth() +
  ylab("Log Adult Body Mass (g)") +
  xlab("Longevity (years)")
```


```{r}
# Relationship between longevity and body size among mammals
Amniote %>% 
  filter(class!="Aves"& class!="Reptilia") %>% 
  ggplot(aes(x=maximum_longevity_y, y=log(adult_body_mass_g))) + 
  geom_density2d()+
  stat_smooth() +
  ylab("Log Adult Body Mass (g)") +
  xlab("Longevity (years)")
```


```{r}
# Relationship between longevity and body size among reptiles
Amniote %>% 
  filter(class!="Aves"& class!="Mammalia") %>% 
  ggplot(aes(x=maximum_longevity_y, y=log(adult_body_mass_g))) + 
  geom_density2d()+
  stat_smooth() +
  ylab("Log Adult Body Mass (g)") +
  xlab("Longevity (years)")
```


```{r}
# Relationship between female body size and egg mass among birds
Amniote %>% 
  filter(class!="Mammalia", class!="Reptilia") %>% 
  ggplot(aes(x=log(egg_mass_g), y=log(female_body_mass_g))) + 
  geom_density2d()+
  stat_smooth() +
  ylab("Log Female Body Mass (g)") +
  xlab("Log Egg Mass (g)")
```


```{r}
# Relationship between female body size and egg mass among reptiles
Amniote %>% 
  filter(class!="Mammalia", class!="Aves") %>% 
  ggplot(aes(x=log(egg_mass_g), y=log(female_body_mass_g))) + 
  geom_density2d()+
  stat_smooth() +
  ylab("Log Female Body Mass (g)") +
  xlab("Log Egg Mass (g)")
```

```{r}
# Relationship between female body size and egg mass among birds and reptiles
Amniote %>% 
  filter(class!="Mammalia") %>% 
  ggplot(aes(x=log(egg_mass_g), y=female_maturity_d)) + 
  geom_density2d()+
  stat_smooth() +
  ylab("Female Maturity (days)") +
  xlab("Log Egg Mass (g)")
```